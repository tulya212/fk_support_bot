import os
import threading

from flask import Flask
from aiogram import Bot, Dispatcher, types, executor
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton
from aiogram.contrib.fsm_storage.memory import MemoryStorage
import json
from aiogram.dispatcher import FSMContext
from aiogram.dispatcher.filters.state import State, StatesGroup

# —Ñ–∞–π–ª –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
VERIFIED_FILE = 'verified.json'

def load_verified() -> set[int]:
    if os.path.exists(VERIFIED_FILE):
        with open(VERIFIED_FILE, 'r', encoding='utf-8') as f:
            return set(json.load(f))
    return set()

def save_verified(users: set[int]):
    with open(VERIFIED_FILE, 'w', encoding='utf-8') as f:
        json.dump(list(users), f, ensure_ascii=False, indent=2)

verified_users = load_verified()

class Form(StatesGroup):
    serial = State()


# ==== –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞ ====
TOKEN = os.getenv("BOT_TOKEN")
bot = Bot(token=TOKEN)
dp = Dispatcher(bot, storage=MemoryStorage())

# ==== –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã ====
main_menu = ReplyKeyboardMarkup(resize_keyboard=True).add("‚òï –í—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å –∫–æ—Ñ–µ–º–∞—à–∏–Ω—ã", )
model_menu = ReplyKeyboardMarkup(resize_keyboard=True).add(
    "Azkoyen Vitro S1", "Azkoyen Vitro S5",
    "Jetinno JL22", "Jetinno JL24", "Jetinno JL300"
)
action_menu = ReplyKeyboardMarkup(resize_keyboard=True).add(
    "üìõ –£ –º–µ–Ω—è –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å!", "üìò –û–±—É—á–µ–Ω–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è"
).add("‚ùì –û—Å—Ç–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã?")
problem_menu = ReplyKeyboardMarkup(resize_keyboard=True, row_width=2).add(
    "üß† –Ø –∑–Ω–∞—é –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
    "üßØ –ü—Ä–æ–ª–∏–≤ –∏–ª–∏ –ø—Ä–æ—Ç–µ—á–∫–∞",
    "üîå –ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è",
    "üíß NO WATER / –Ω–µ—Ç –≤–æ–¥—ã",
    "üóë –°–ª–∏–≤ –æ—Ç—Ö–æ–¥–æ–≤ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç",
    "üîß –ó–∞–≤–∞—Ä–æ—á–Ω—ã–π –±–ª–æ–∫ (F.ESPRSS.UNT.POS)"
)

# ==== –°–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö —Å–µ—Ä–∏–π–Ω–∏–∫–æ–≤ ====
allowed_serials = {
    "0010258608", "0010289689", "0010289069", "0010289073",
    "0010289071", "0010289697", "0010289699", "0010289310",
    "0010289690", "0010289070", "0010276287", "0010289230",
    "0010294124", "0010299304", "0010299303", "0010299305",
    "0010299306", "0010271325", "0010289062", "0010289233",
    "0010294125", "0010289067", "0010289693", "0010280734",
    "0010311211", "0010299302", "0010299297", "0010299307",
    "0010308787", "0010299328", "0010298017", "0010298018",
    "0010298101", "0010298019", "0010298102", "0010298020",
    "0010298016", "0010304011", "0010301717", "0010302157",
    "0010301716", "0010302153", "0010302156", "0010302154",
    "0010301192", "0010301720", "0010299329", "0010299330",
    "0010302155", "0010299327", "DCEC 21BBTEECU90", "0010276286",
    "0010308785", "0010305788", "0010306890", "0010305791",
    "0010305892", "0010305790", "0010306889", "0010306887",
    "0010308786", "0010306892", "0010308789", "0010311210",
    "0010311510", "0010311511", "0010311507", "0010306879",
    "0010311509", "0010311508", "0010313377", "0010313378",
    "0010311669", "0010289067", "0010289693", "10280734",
    "0010289071", "0010289697", "0010289699", "0010271325",
    "0010289062", "2024416002", "0010299302", "0010313904",
    "0010314805", "0010317827", "0010317828", "2411129852",
    "2411129856", "2411129848", "2411129845", "2411129850",
    "2411129855", "2411129842", "2411129851", "2411129841",
    "2411129837", "2411129847", "2411129838", "2411129857",
    "2411129853", "2411129859", "2411129846", "2411129839",
    "2411129858", "2411129844", "2411129860", "2411129861",
    "2411129854", "2411129849", "2411129843", "2411129840",
    "2402100642", "2402100618", "2410124638", "2410124599",
    "2410124590", "2410124595", "2410124587", "2503148242",
    "2503148230", "2503148239", "2503148217", "2503148219",
    "2503148237", "2503148226", "2503148228", "2503148227",
    "2503148218", "2503148234", "2503148235", "2503148238",
    "2503148216", "2412132984", "2412132780", "2412132847",
    "2412132983", "2412132947", "2412132875", "2412132981"
}

verified_users = set()

# ==== Handlers ====

@dp.message_handler(commands=['start'], state='*')
async def cmd_start(message: types.Message, state: FSMContext):
    if message.from_user.id in verified_users:
        await state.finish()
        await message.answer("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:", reply_markup=main_menu)
    else:
        await Form.serial.set()
        await message.answer("üëã –ü—Ä–∏–≤–µ—Ç! –í–≤–µ–¥–∏—Ç–µ —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –≤–∞—à–µ–π –∫–æ—Ñ–µ–º–∞—à–∏–Ω—ã:")
)

@dp.message_handler(state=Form.serial)
async def process_serial(message: types.Message, state: FSMContext):
    sn = message.text.strip()
    if sn in allowed_serials:
        verified_users.add(message.from_user.id)
        save_verified(verified_users)
        await state.finish()
        await message.answer("‚úÖ –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω!", reply_markup=main_menu)
    else:
        await message.answer("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑:")

@dp.message_handler(lambda m: m.text == "‚òï –í—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å –∫–æ—Ñ–µ–º–∞—à–∏–Ω—ã")
async def choose_model(message: types.Message):
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å:", reply_markup=model_menu)

@dp.message_handler(lambda m: m.text.startswith(("Azkoyen", "Jetinno")))
async def model_selected(message: types.Message):
    if "Azkoyen" in message.text:
        text = (
            "‚ÑπÔ∏è –í–ê–ñ–ù–û\n\n"
            "–ù–∞ —ç–∫—Ä–∞–Ω–µ Azkoyen –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫ ‚Äî —ç—Ç–æ –æ—à–∏–±–∫–∞.\n"
            "–û—Ç–∫—Ä–æ–π—Ç–µ –¥–≤–µ—Ä—å –∏ –Ω–∞–∂–º–∏—Ç–µ PROG/C, –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–ø—Ä–∞–≤–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ.\n\n"
            "–ï—Å–ª–∏ –Ω–µ—Ç –≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ ‚Äî –æ—à–∏–±–æ–∫ –Ω–µ—Ç. –ò–Ω–∞—á–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ."
        )
    else:
        text = (
            "‚ÑπÔ∏è –í–ê–ñ–ù–û\n\n"
            "–ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –ª–æ–≥–æ—Ç–∏–ø Fastkava –≤ —É–≥–ª—É, –≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å.\n"
            "–°–º–æ—Ç—Ä–∏—Ç–µ –∂—É—Ä–Ω–∞–ª –æ—à–∏–±–æ–∫ —Å–ø—Ä–∞–≤–∞."
        )
    await message.answer(text)
    await message.answer("–ß—Ç–æ –¥–µ–ª–∞–µ–º –¥–∞–ª—å—à–µ?", reply_markup=action_menu)

@dp.message_handler(lambda m: m.text == "üìõ –£ –º–µ–Ω—è –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å!")
async def problems_list(message: types.Message):
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É:", reply_markup=problem_menu)

@dp.message_handler(lambda msg: "F.ESPRSS.UNT.POS" in msg.text.upper() or "G.ESPRESSO UNIT" in msg.text.upper())
async def espress_unit_error(message: types.Message):
    await message.answer(
        "üîß –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞: F.ESPRSS.UNT.POS (G.ESPRESSO UNIT)\n\n"
        "‚ùó –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –∑–∞–≤–∞—Ä–æ—á–Ω—ã–π –±–ª–æ–∫ ¬´–∑–∞—Å—Ç—Ä—è–ª¬ª –º–µ–∂–¥—É –ø–æ–∑–∏—Ü–∏—è–º–∏ –∏–ª–∏ –Ω–µ –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ.\n\n"
        "üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—à–∞–≥–æ–≤–æ:\n"
        "1. ‚ö° –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç\n"
        "   ‚Äî –û—Ç–∫–ª—é—á–∏—Ç–µ –ø–∏—Ç–∞–Ω–∏–µ, –ø–æ–¥–æ–∂–¥–∏—Ç–µ 5‚Äâ—Å–µ–∫ –∏ –≤–∫–ª—é—á–∏—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ\n"
        "   ‚Äî –î–æ–ª–∂–Ω—ã —Å–ª—ã—à–∞—Ç—å—Å—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ ¬´–≥—É–ª¬ª –∏ —â–µ–ª—á–æ–∫ –º–æ—Ç–æ—Ä–∞, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–µ–≥–æ –±–ª–æ–∫\n\n"
        "2. üö™ –û—Ç–∫—Ä–æ–π—Ç–µ –¥–≤–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∞ –∏ —É–±–µ–¥–∏—Ç–µ—Å—å:\n"
        "   ‚Ä¢ –í—Å—ë —Å—Ç–æ–∏—Ç —Ä–æ–≤–Ω–æ, –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–∫–ª–∏–Ω–∏–ª–æ\n"
        "   ‚Ä¢ –ë–ª–æ–∫ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω ¬´—Ñ–ª–∞–∂–∫–∞–º–∏¬ª —Å–≤–µ—Ä—Ö—É-—Å–ø—Ä–∞–≤–∞ –∏ —Å–Ω–∏–∑—É-—Å–ª–µ–≤–∞\n\n"
        "üîß –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ ‚Äî —Å–Ω–∏–º–∏—Ç–µ –∑–∞–≤–∞—Ä–æ—á–Ω—ã–π –±–ª–æ–∫ –≤—Ä—É—á–Ω—É—é:\n"
        "   1. –ù–∞–π–¥–∏—Ç–µ –ø–æ—Ä—à–µ–Ω—å (–∫ –Ω–µ–º—É –ø–æ–¥—Ö–æ–¥–∏—Ç –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Ç—Ä—É–±–∫–∞ –ø–æ–¥–∞—á–∏ –∫–æ—Ñ–µ)\n"
        "   2. –°–Ω–∏–º–∏—Ç–µ –º–∏–∫—Å–µ—Ä (–±–µ–∂–µ–≤–∞—è –¥–µ—Ç–∞–ª—å —Å –∫—Ä–∞—Å–Ω–æ–π —Ç—Ä—É–±–∫–æ–π)\n"
        "   3. –†–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ –∫—Ä–µ–ø–ª–µ–Ω–∏—è: –ø–µ—Ä–µ–≤–µ–¥–∏—Ç–µ ¬´—Ñ–ª–∞–∂–∫–∏¬ª –≤ –æ—Ç–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ, –ø–æ—Ç—è–Ω–∏—Ç–µ –±–ª–æ–∫ –≤–≤–µ—Ä—Ö ‚Äî —Å–Ω–∏–º–∏—Ç–µ\n"
        "   4. –í–Ω—É—Ç—Ä–∏ –≤—ã —É–≤–∏–¥–∏—Ç–µ –∑–∞–ø—Ä–µ—Å—Å–æ–≤–∞–Ω–Ω—É—é —Ç–∞–±–ª–µ—Ç–∫—É ‚Äî –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ –≤—ã–∫–æ–≤—ã—Ä—è–π—Ç–µ –µ—ë –∑—É–±–æ—á–∏—Å—Ç–∫–æ–π –∏–ª–∏ –Ω–æ–∂–æ–º\n"
        "   5. –ü—Ä–æ–º–æ–π—Ç–µ –±–ª–æ–∫, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ:\n"
        "      ‚Ä¢ –ó–∞–∫—Ä–µ–ø–∏—Ç–µ –æ–±–∞ ¬´—Ñ–ª–∞–∂–∫–∞¬ª\n"
        "      ‚Ä¢ –í—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–±—É –ø–æ—Ä—à–Ω—è –Ω–∞ –º–µ—Å—Ç–æ\n"
        "      ‚Ä¢ –ü–ª–æ—Ç–Ω–æ –∑–∞—â—ë–ª–∫–Ω–∏—Ç–µ –º–∏–∫—Å–µ—Ä\n\n"
        "6. ‚ö° –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç –µ—â—ë —Ä–∞–∑\n\n"
        "üì∏ –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–ª–∞—Å—å ‚Äî —Å–¥–µ–ª–∞–π—Ç–µ —Ñ–æ—Ç–æ –±–ª–æ–∫–∞ –≤–Ω—É—Ç—Ä–∏ –∏ –≤—ã—à–ª–∏—Ç–µ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–µ."
    )

@dp.message_handler(lambda m: "F.MONEY SYSTEM" in m.text.upper(), state='*')
async def money_system_error(message: types.Message):
    await message.answer(
        "üí∞ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞: F.MONEY SYSTEM\n\n"
        "‚ùó –ù–µ –ø—É–≥–∞–π—Ç–µ—Å—å ‚Äî —ç—Ç–∞ –æ—à–∏–±–∫–∞ –æ–±—ã—á–Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞—á–∏—Ç –∏ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É.\n"
        "–ü—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏—Ç–µ **PROG/C**, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å –µ—ë.\n\n"
        "–ï—Å–ª–∏ –∏–∑-–∑–∞ –Ω–µ—ë –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ü–µ–Ω—ã –Ω–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∞–ø–ø–∞—Ä–∞—Ç."
    )


@dp.message_handler(lambda m: "WASTE BIN FULL" in m.text.upper(), state='*')
async def waste_bin_full_error(message: types.Message):
    await message.answer(
        "üóë –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞: WASTE BIN FULL\n\n"
        "‚ùó –°—á—ë—Ç—á–∏–∫ –æ—Ç—Ö–æ–¥–æ–≤ –¥–æ—Å—Ç–∏–≥ –º–∞–∫—Å–∏–º—É–º–∞ ‚Äî –∞–ø–ø–∞—Ä–∞—Ç –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –ø–æ–∫–∞ –µ–≥–æ –Ω–µ —Å–±—Ä–æ—Å—è—Ç.\n\n"
        "üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ —Å–±—Ä–æ—Å—å—Ç–µ —Å—á—ë—Ç—á–∏–∫ –ø–æ—à–∞–≥–æ–≤–æ:\n"
        "1. üóë **–û–ø–æ—Ä–æ–∂–Ω–∏—Ç–µ –ª–æ—Ç–æ–∫ –¥–ª—è –æ—Ç—Ö–æ–¥–æ–≤** –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ –¥–æ —â–µ–ª—á–∫–∞.\n"
        "2. üßº **–û—á–∏—Å—Ç–∏—Ç–µ –ª–æ—Ç–æ–∫ –∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –ø–ª–æ—â–∞–¥–∫—É** –æ—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤ –Ω–∞–ø–∏—Ç–∫–æ–≤ –∏ –º—É—Å–æ—Ä–∞.\n\n"
        "3. üîß **–í–æ–π–¥–∏—Ç–µ –≤ —Å–µ—Ä–≤–∏—Å–Ω–æ–µ –º–µ–Ω—é**:\n"
        "   ‚Ä¢ –ù–∞–∂–º–∏—Ç–µ **PROG/C** –Ω–∞ –ø–µ—Ä–µ–¥–Ω–µ–π –ø–∞–Ω–µ–ª–∏.\n"
        "4. ‚è© **–õ–∏—Å—Ç–∞–π—Ç–µ –∫–Ω–æ–ø–∫–æ–π A** –¥–æ –ø—É–Ω–∫—Ç–∞ **0.30 Test Machine**, –Ω–∞–∂–º–∏—Ç–µ **D**.\n"
        "5. ‚è© **–ö–Ω–æ–ø–∫–æ–π A** –Ω–∞–π–¥–∏—Ç–µ –ø—É–Ω–∫—Ç **114 (Waste Bin Reset)**, –Ω–∞–∂–º–∏—Ç–µ **D**.\n"
        "6. 0Ô∏è‚É£ **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ** —Å—á—ë—Ç—á–∏–∫–∞ –Ω–∞ **00000** —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–æ–∫ A/B.\n"
        "7. ‚úÖ **–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å–±—Ä–æ—Å** –Ω–∞–∂–∞—Ç–∏–µ–º **D**.\n"
        "8. üîô **–í—ã–π–¥–∏—Ç–µ** –∏–∑ –º–µ–Ω—é –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –Ω–∞–∂–∞—Ç–∏—è–º–∏ **C**.\n\n"
        "9. ‚ö° **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç**:\n"
        "   ‚Ä¢ –û—Ç–∫–ª—é—á–∏—Ç–µ –ø–∏—Ç–∞–Ω–∏–µ –Ω–∞ 5‚Äì10 —Å–µ–∫ –∏ –≤–∫–ª—é—á–∏—Ç–µ —Å–Ω–æ–≤–∞.\n\n"
        "üì∏ –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, –∏—Å—á–µ–∑–ª–∞ –ª–∏ –æ—à–∏–±–∫–∞. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø—Ä–∏—à–ª–∏—Ç–µ —Ñ–æ—Ç–æ —ç–∫—Ä–∞–Ω–∞ –∏ –ø–æ–ª–æ–∂–µ–Ω–∏—è –ª–æ—Ç–∫–∞."
    )


@dp.message_handler(lambda msg: "NO WASTE BIN" in msg.text.upper())
async def no_waste_bin_error(message: types.Message):
    await message.answer(
        "üóë –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞: NO WASTE BIN\n\n"
        "‚ùó –ê–ø–ø–∞—Ä–∞—Ç –Ω–µ –≤–∏–¥–∏—Ç –ª–æ—Ç–æ–∫ –¥–ª—è –æ—Ç—Ö–æ–¥–æ–≤.\n\n"
        "üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—à–∞–≥–æ–≤–æ:\n"
        "1. üì¶ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ª–æ—Ç–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤–Ω—É—Ç—Ä–∏\n"
        "   ‚Äî –ò–Ω–æ–≥–¥–∞ –µ–≥–æ –∑–∞–±—ã–≤–∞—é—Ç –≤–µ—Ä–Ω—É—Ç—å –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏\n\n"
        "2. üîÑ –í—ã–Ω—å—Ç–µ –ª–æ—Ç–æ–∫ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ –¥–æ —É–ø–æ—Ä–∞\n"
        "   ‚Äî –õ–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –ø–ª–æ—Ç–Ω–æ –≤–æ–π—Ç–∏ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–º\n\n"
        "3. üßº –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –ø–ª–æ—â–∞–¥–∫—É –∏ —Å–∞–º –ª–æ—Ç–æ–∫:\n"
        "   ‚Ä¢ –ö–æ–Ω—Ç–∞–∫—Ç—ã —á–∏—Å—Ç—ã–µ, –±–µ–∑ –ø–æ—Ä–æ—à–∫–∞ –∏ –∫–∞–ø–µ–ª—å\n"
        "   ‚Ä¢ –õ–æ—Ç–æ–∫ –Ω–µ –ø–µ—Ä–µ–∫–æ—à–µ–Ω, –Ω–µ –∑–∞–±–∏—Ç –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –Ω–∞–ø–∏—Ç–∫–æ–≤\n\n"
        "‚öôÔ∏è –ï—Å–ª–∏ –Ω–µ —É—Ö–æ–¥–∏—Ç ‚Äî —Å–±—Ä–æ—Å—å—Ç–µ —Å—á—ë—Ç—á–∏–∫ –æ—Ç—Ö–æ–¥–æ–≤:\n"
        "   ‚Ä¢ –í —Å–µ—Ä–≤–∏—Å–Ω–æ–º –º–µ–Ω—é (PROG/C) –≤—ã–±–µ—Ä–∏—Ç–µ Test Machine ‚Üí –ø—É–Ω–∫—Ç 114\n"
        "   ‚Ä¢ –ù–∞–∂–º–∏—Ç–µ D, –∑–∞—Ç–µ–º –∫–Ω–æ–ø–∫–∞–º–∏ A/B —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ —Ü–∏—Ñ—Ä—ã –≤ 00000\n"
        "   ‚Ä¢ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∏ –≤—ã–π–¥–∏—Ç–µ ‚Äî –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –Ω–∞–∂–º–∏—Ç–µ C\n"
        "   ‚Ä¢ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç 2‚Äì3 —Ä–∞–∑–∞\n\n"
        "üì∏ –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –Ω–µ—Ç ‚Äî —Å—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–π—Ç–µ —ç–∫—Ä–∞–Ω –∏ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ª–æ—Ç–∫–∞."
    )

@dp.message_handler(lambda m: "GRINDER JAM" in m.text.upper(), state='*')
async def grinder_jam_error(message: types.Message):
    await message.answer(
        "üîß –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞: GRINDER JAM\n\n"
        "‚ùó –ó—É–±—å—è –∫–æ—Ñ–µ–º–æ–ª–∫–∏ –∑–∞–µ–¥–∞—é—Ç –∏ –Ω–µ –≤—Ä–∞—â–∞—é—Ç—Å—è.\n\n"
        "üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—à–∞–≥–æ–≤–æ:\n"
        "1. ‚ö° –û—Ç–∫–ª—é—á–∏—Ç–µ –ø–∏—Ç–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∞\n"
        "2. üåæ –û—Ç–∫—Ä–æ–π—Ç–µ –±—É–Ω–∫–µ—Ä –¥–ª—è –∑—ë—Ä–µ–Ω –∏ –ø–µ—Ä–µ–∫—Ä–æ–π—Ç–µ –≤—ã—Ö–æ–¥ –∫–æ—Ñ–µ —Ä—ã—á–∞–≥–æ–º –Ω–∏–∂–µ (–¥–æ—Å—Ç–∞–Ω—å—Ç–µ –±—É–Ω–∫–µ—Ä):\n"
        "   ‚Ä¢ –í—ã–Ω—å—Ç–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∑—ë—Ä–Ω–∞ ‚Äî –æ–Ω–∏ –º–æ–≥–ª–∏ —Å–ª—ë–∂–∞—Ç—å—Å—è\n"
        "   ‚Ä¢ –ü—Ä–æ—á–∏—Å—Ç–∏—Ç–µ —Å—Ç–µ–Ω–∫–∏ –±—É–Ω–∫–µ—Ä–∞ –º—è–≥–∫–æ–π —â—ë—Ç–∫–æ–π\n"
        "3. ‚öôÔ∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∂–µ—Ä–Ω–æ–≤–∞:\n"
        "   ‚Ä¢ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–µ–∂–¥—É –∑—É–±—å—è–º–∏ –Ω–µ—Ç –ø–æ–ø–∞–¥–∞–Ω–∏–π –∫—Ä—É–ø–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü\n"
        "   ‚Ä¢ –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–Ω–∏–º–∏—Ç–µ –∂–µ—Ä–Ω–æ–≤–∞ –∏ –æ—á–∏—Å—Ç–∏—Ç–µ –∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ\n"
        "4. üîÑ –°–æ–±–µ—Ä–∏—Ç–µ –≤—Å—ë –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –∏ –≤–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç:\n"
        "   ‚Äî –î–æ–ª–∂–Ω—ã –ø—Ä–æ–∑–≤—É—á–∞—Ç—å —Ä–æ–≤–Ω—ã–π –≥—É–ª –∏ —â—ë–ª—á–∫–∏ –ø—Ä–∏ –≤—Ä–∞—â–µ–Ω–∏–∏ –∂–µ—Ä–Ω–æ–≤–æ–≤\n\n"
        "üìπ –í–∏–¥–µ–æ–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º—ã: https://t.me/fastkavanews/105"
    )

@dp.message_handler(lambda m: "NO COFFEE BEANS" in m.text.upper(), state='*')
async def no_coffee_beans_error(message: types.Message):
    await message.answer(
        "ü´ò –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞: NO COFFEE BEANS\n\n"
        "‚ùó –ê–ø–ø–∞—Ä–∞—Ç –Ω–µ –≤–∏–¥–∏—Ç –∑—ë—Ä–Ω–∞ –≤ –±—É–Ω–∫–µ—Ä–µ –∏–ª–∏ –Ω–µ –ø–æ–¥–∞—ë—Ç –∏—Ö –≤ –∂–µ—Ä–Ω–æ–≤–∞.\n\n"
        "üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—à–∞–≥–æ–≤–æ:\n"
        "1. üåæ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –±—É–Ω–∫–µ—Ä–µ –µ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ–∂–∏—Ö –∑—ë—Ä–µ–Ω\n"
        "2. üîÑ –®–µ–≤–µ–ª–∏—Ç–µ –±—É–Ω–∫–µ—Ä ‚Äî –∑—ë—Ä–Ω–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã —Å–ª—ë–∂–∏–≤–∞—Ç—å—Å—è –ø–ª–æ—Ç–Ω—ã–º –∫–æ–º–æ–º\n"
        "3. üîß –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä—ã—á–∞–≥ –∑–∞—Å–ª–æ–Ω–∫–∏ —á—É—Ç—å –Ω–∏–∂–µ –∫–æ—Ñ–µ–π–Ω–æ–≥–æ –±—É–Ω–∫–µ—Ä–∞ ‚Äî –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤ –ª–µ–≤–æ–º –ø–æ–ª–æ–∂–µ–Ω–∏–∏\n"
        "4. ‚öôÔ∏è –û—á–∏—Å—Ç–∏—Ç–µ –±—É–Ω–∫–µ—Ä –∏ —à–Ω–µ–∫ –æ—Ç —Å—Ç–∞—Ä—ã—Ö —á–∞—Å—Ç–∏—Ü:\n"
        "   ‚Ä¢ –°–Ω–∏–º–∏—Ç–µ –±—É–Ω–∫–µ—Ä, –≤—ã—Ç—Ä—è—Ö–Ω–∏—Ç–µ –æ—Å—Ç–∞—Ç–∫–∏\n"
        "   ‚Ä¢ –ü—Ä–æ—Ç—Ä–∏—Ç–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Ç–µ–Ω–∫–∏ –∏ —à–Ω–µ–∫ –º—è–≥–∫–æ–π —Å—É—Ö–æ–π —Ç—Ä—è–ø–∫–æ–π\n\n"
        "üì∏ –ï—Å–ª–∏ –∑—ë—Ä–Ω–∞ –≤—Å—ë –µ—â—ë –Ω–µ –ø–æ–¥–∞—é—Ç—Å—è ‚Äî –ø—Ä–∏—à–ª–∏—Ç–µ –≤–∏–¥–µ–æ –±—É–Ω–∫–µ—Ä–∞ –∏ —à–Ω–µ–∫–∞ –≤ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É."
    )

@dp.message_handler(lambda m: "FAIL WATER LEVEL" in m.text.upper(), state='*')
async def fail_water_level_error(message: types.Message):
    await message.answer(
        "üíß –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞: FAIL WATER LEVEL\n\n"
        "‚ùó –ê–ø–ø–∞—Ä–∞—Ç –Ω–µ —É–¥–∞—ë—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –≤–æ–¥—ã –≤ –±–∞–∫–µ.\n\n"
        "üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—à–∞–≥–æ–≤–æ:\n"
        "1. –ó–∞–π–¥–∏—Ç–µ –≤ —Å–µ—Ä–≤–∏—Å–Ω–æ–µ –º–µ–Ω—é PROG/C –∏ –ª–∏—Å—Ç–∞–π—Ç–µ –∫–Ω–æ–ø–∫–æ–π A –¥–æ –ø—É–Ω–∫—Ç–∞ 456 AUTONOMY, –Ω–∞–∂–º–∏—Ç–µ D.\n"
        "   ‚Ä¢ –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–æ–¥—ã, –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –ø–æ –æ—á–µ—Ä–µ–¥–∏, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—è –∫–Ω–æ–ø–∫–æ–π D.\n"
        "   ‚Ä¢ –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∏—Ç–µ –Ω–∞ –≥–ª–∞–≤–Ω—É—é PROG/C –∏ –ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç (1‚Äì2 —Ä–∞–∑–∞).\n"
        "   ‚Ä¢ –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –æ—á–∏—Å—Ç–∫—É –æ—Ç –Ω–∞–∫–∏–ø–∏.\n"
        "     –ó–∞–∫–∞–∂–∏—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤–æ: https://allegro.pl/oferta/odkamieniacz-do-ek—Å–ø—Ä–µ—Å–æ–≤-kamix-express-500ml-16645645964\n\n"
        "üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ—á–∏—Å—Ç–∫–µ –æ—Ç –Ω–∞–∫–∏–ø–∏ (Descaling) ‚Äì Azkoyen Vitro S1/5:\n"
        "1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–∞—Å—Ç–≤–æ—Ä–∞:\n"
        "   ‚Ä¢ –†–∞–∑–≤–µ–¥–∏—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è (–º–æ–∂–Ω–æ —á—É—Ç—å –º–µ–Ω—å—à–µ –≤–æ–¥—ã –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏).\n"
        "   ‚Ä¢ –•–æ—Ä–æ—à–æ —Ä–∞–∑–º–µ—à–∞–π—Ç–µ –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –∑–∞–±–æ—Ä–Ω—É—é —Ç—Ä—É–±–∫—É –≤ —Ä–∞—Å—Ç–≤–æ—Ä.\n\n"
        "2. –ó–∞–ø—É—Å–∫ —Ü–∏–∫–ª–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞–∫–∏–ø–∏:\n"
        "   1) –ù–∞–∂–º–∏—Ç–µ PROG/C, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –∫ ¬´0.30 Test Machine¬ª –∏ –Ω–∞–∂–º–∏—Ç–µ D.\n"
        "   2) –ö–Ω–æ–ø–∫–æ–π A –≤—ã–±–µ—Ä–∏—Ç–µ ¬´Descaling¬ª –∏ –Ω–∞–∂–º–∏—Ç–µ D –¥–ª—è —Å—Ç–∞—Ä—Ç–∞.\n\n"
        "3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –º–∏–∫—Å–µ—Ä–æ–≤:\n"
        "   ‚Ä¢ –ü–æ—Å–ª–µ Descaling –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ–º—ã–≤–∫—É –º–∏–∫—Å–µ—Ä–æ–≤ –¥–æ 5 —Ä–∞–∑ —Ç–µ–º –∂–µ —Ä–∞—Å—Ç–≤–æ—Ä–æ–º.\n\n"
        "4. –ü—Ä–æ–º—ã–≤–∫–∞ —á–∏—Å—Ç–æ–π –≤–æ–¥–æ–π:\n"
        "   1) –í—ã–Ω—å—Ç–µ –∑–∞–±–æ—Ä–Ω—É—é —Ç—Ä—É–±–∫—É, –ø—Ä–æ—Ç—Ä–∏—Ç–µ –µ—ë –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –≤ —á–∏—Å—Ç—É—é –≤–æ–¥—É.\n"
        "   2) –ó–∞–ø—É—Å—Ç–∏—Ç–µ Descaling 2 —Ä–∞–∑–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ —Ö–∏–º–∏–∏.\n"
        "   3) –ü—Ä–æ–º–æ–π—Ç–µ –º–∏–∫—Å–µ—Ä—ã 2‚Äì3 —Ä–∞–∑–∞ —á–∏—Å—Ç–æ–π –≤–æ–¥–æ–π.\n\n"
        "5. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:\n"
        "   ‚Ä¢ –ü—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ –Ω–∞–ø–∏—Ç–æ–∫ —Å –º–æ–ª–æ–∫–æ–º –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω–æ –Ω–µ —Å–≤–µ—Ä–Ω—É–ª–æ—Å—å.\n"
        "   ‚Ä¢ –ï—Å–ª–∏ —Å–≤–µ—Ä–Ω—É–ª–æ—Å—å, –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø—Ä–æ–º—ã–≤–∫—É.\n\n"
        "üìπ –í–∏–¥–µ–æ–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: https://t.me/fastkavanews/106"
    )


@dp.message_handler(lambda msg: "NO WATER" in msg.text.upper())
async def no_water_error(message: types.Message):
    await message.answer(
        "üíß –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –æ—à–∏–±–∫–∞: NO WATER\n\n"
        "‚ùó –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∞–≤—Ç–æ–º–∞—Ç –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–±—Ä–∞—Ç—å –≤–æ–¥—É.\n\n"
        "üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—à–∞–≥–æ–≤–æ:\n"
        "1. üì¶ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–∞–Ω–∏—Å—Ç—Ä–µ –µ—Å—Ç—å –≤–æ–¥–∞\n"
        "2. üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∞—á—É:\n"
        "   ‚Ä¢ –¢—Ä—É–±–∫–∞ –ø–æ–¥–∞—á–∏ –Ω–µ –ø–µ—Ä–µ–∂–∞—Ç–∞ (–ø–æ–¥ –Ω–æ–∂–∫–æ–π –∏–ª–∏ –≤ –º–µ–±–µ–ª—å–Ω–æ–º –æ—Ç–≤–µ—Ä—Å—Ç–∏–∏)\n\n"
        "3. ‚ö° –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç\n"
        "   ‚Äî –û—Ç–∫–ª—é—á–∏—Ç–µ/–≤–∫–ª—é—á–∏—Ç–µ –ø–∏—Ç–∞–Ω–∏–µ\n"
        "   ‚Äî –ò–Ω–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ø—ã—Ç–æ–∫, —á—Ç–æ–±—ã –Ω–∞—Å–æ—Å ¬´–≤—Å–æ—Å–∞–ª¬ª –≤–æ–¥—É\n"
        "   ‚Äî –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ª—ã—à–Ω—ã –∑–≤—É–∫–∏ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –Ω–∞—Å–æ—Å–∞\n\n"
        "üì∏ –ï—Å–ª–∏ –¥–∞–∂–µ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤–æ–¥–∞ –Ω–µ –∏–¥—ë—Ç ‚Äî –ø—Ä–∏—à–ª–∏—Ç–µ —Ñ–æ—Ç–æ –∫–∞–Ω–∏—Å—Ç—Ä—ã –∏ —Ç—Ä—É–±–æ–∫."
    )

# ==== HTTP –¥–ª—è Render (keep-alive) ====
app = Flask(__name__)

@app.route("/")
def ping():
    return "OK", 200

def run_flask():
    port = int(os.getenv("PORT", 5000))
    app.run(host="0.0.0.0", port=port)

# ==== –°–±—Ä–æ—Å webhook –ø–µ—Ä–µ–¥ polling ====
async def on_startup(dp: Dispatcher):
    await bot.delete_webhook(drop_pending_updates=True)

# ==== –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ ====
if __name__ == "__main__":
    # 1) HTTP-—Å–µ—Ä–≤–µ—Ä –¥–ª—è Render
    threading.Thread(target=run_flask, daemon=True).start()
    # 2) –ó–∞–ø—É—Å–∫ long-polling
    executor.start_polling(
        dispatcher=dp,
        skip_updates=True,
        on_startup=on_startup
    )


